<?xml version="1.0" encoding="WINDOWS-1252" ?>
<report name="x_ressmoi_client" DTDVersion="9.0.2.0.10"
 afterParameterFormTrigger="afterpform">
  <xmlSettings xmlTag="X_RESSMOI_CLIENT" xmlPrologType="text">
  <![CDATA[<?xml version="1.0"?>]]>
  </xmlSettings>
  <reportHtmlEscapes>
    <beforeReportHtmlEscape>
    <![CDATA[<html>
<body dir=&Direction bgcolor="#ffffff">
]]>
    </beforeReportHtmlEscape>
    <beforePageHtmlEscape>
    <![CDATA[#NULL#]]>
    </beforePageHtmlEscape>
    <afterPageHtmlEscape>
    <![CDATA[<hr size=5 noshade>
]]>
    </afterPageHtmlEscape>
    <beforeFormHtmlEscape>
    <![CDATA[<html>
<body dir=&Direction bgcolor="#ffffff">
<form method=post action="_action_">
<input name="hidden_run_parameters" type=hidden value="_hidden_">
<font color=red><!--error--></font>
<center>
<p><table border=0 cellspacing=0 cellpadding=0>
<tr>
<td><input type=submit></td>
<td width=15>
<td><input type=reset></td>
</tr>
</table>
<p><hr><p>
]]>
    </beforeFormHtmlEscape>
    <pageNavigationHtmlEscape>
    <![CDATA[<HTML>
<TITLE>Oracle HTML Navigator</TITLE>
<HEAD>
<SCRIPT LANGUAGE = "JavaScript">

var jump_index = 1			// Jump to this page
var num_pages = &TotalPages			// Total number of pages
var basefilename = "&file_name"		// Base file name
var fileext = "&file_ext"		//File extension

/* jumps to "new_page" */
function new_page(form, new_page)
{
	form.reqpage.value = new_page;
	parent.frames[0].location = basefilename + "_" + new_page + "."+fileext;
}

/* go back one page */
function back(form)
{
	/* if we are not in first page */
	if (jump_index > 1)
	{
		jump_index--;
		new_page(form, jump_index);
	}
}

/* go forward one page */
function forward(form)
{
	/* if we are not in last page */
	if (jump_index < num_pages)
	{
		jump_index++;
		new_page(form, jump_index);
	}
}

/* go to first page */
function first(form)
{
	if(jump_index != 1)
	{
		jump_index = 1;
		new_page(form, jump_index);
	}
}

/* go to last page */
function last(form)
{
	if(jump_index != num_pages)
	{
		jump_index = num_pages;
		new_page(form, jump_index);
	}
}

/* go to the user specified page number */
function pagenum(form)
{
	/* sanity check */
	if (form.reqpage.value < 1)
	{
		form.reqpage.value = 1;
	}
	if (form.reqpage.value > num_pages)
	{
		form.reqpage.value = num_pages;
	}
	jump_index = form.reqpage.value;
	new_page(form, jump_index);
}
</SCRIPT>
</HEAD>

<BODY>
<FORM NAME="ThisForm" onSubmit="pagenum(this); return false;">
<center><table><tr>
<td> <INPUT TYPE="button"  VALUE="<< " onClick="first(this.form)">
<td> <INPUT TYPE="button"  VALUE=" < " onClick="back(this.form)">
<td> <INPUT TYPE="button"  VALUE="Page:" onClick="pagenum(this.form)">
<td> <INPUT NAME="reqpage" VALUE="1" SIZE=2>
<td> <INPUT TYPE="button"  VALUE=" > " onClick="forward(this.form)">
<td> <INPUT TYPE="button"  VALUE=" >>" onClick="last(this.form)">
</table></center>
</FORM></BODY>
</HTML>
]]>
    </pageNavigationHtmlEscape>
  </reportHtmlEscapes>
  <data>
    <userParameter name="P_param6" datatype="character" precision="10"
     label="P Param6" defaultWidth="0" defaultHeight="0">
      <listOfValues restrictToList="yes">
        <staticValues>
          <validValue value=".CSV"/>
          <validValue value=".TXT"/>
        </staticValues>
      </listOfValues>
    </userParameter>
    <userParameter name="P_global" datatype="character" width="5024"
     precision="10" label="P Global" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param7" datatype="character" width="7"
     precision="10" label="P Param7" defaultWidth="0" defaultHeight="0">
      <comment>
      <![CDATA[Code DPG]]>
      </comment>
    </userParameter>
    <userParameter name="P_perime" datatype="character" width="5024"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param1" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param2" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param3" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param4" datatype="character" precision="10"
     defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param5" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_WHERE" datatype="character" width="5024"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM8" datatype="character" precision="10"
     defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_A" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_DP" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_P" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_CAFI" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HAB" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <systemParameter name="MODE" initialValue="Default"/>
    <systemParameter name="ORIENTATION" initialValue="Default"/>
    <dataSource name="Q_1">
      <select>
      <![CDATA[-- Crée le 20/08/2003 par NBM
--Toutes les ressources du DPG choisi mois par mois du début de l'année jusqu'au mois courant-1 (datdebex.moismens-1)
--Pour chaque mois, on veut la ligne BIP de la ressource et son consommé.

SELECT rpad( NVL( pid, ' '),  4,  ' ') 					PID,
	substr( NVL( ptype, ' '), 1, 1)  					PTYPE,
	rpad( NVL( pnom, ' '), 30, ' ')					PNOM,
	lpad( NVL( TO_CHAR(pdsg), ' '), 7, '0')				PDSG,
	rpad( NVL( pcmouvra, ' '), 5, ' ')				PCMOUVRA,
	rpad( NVL( TO_CHAR(cdeb, 'MMYYYY'), '0'), 6, '0') 		CDEB,
	lpad( NVL( TO_CHAR(tires), '0'), 5, '0')				TIRES,
	rpad( NVL( aist, ' '), 6, ' ')					AIST,
	rpad( NVL( soccode, ' '), 4, ' ')					SOCCODE,
rpad( NVL( socgrpe, ' '), 4, ' ')					SOCGRPE,
	decode(:P_param6,'.CSV',
		lpad( NVL( TO_CHAR(couttc,  'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' ') ,
		lpad( NVL( TO_CHAR(couttc,  'FM9999999999.00'), '0.00'), 13, ' '))	COUTTC,
	decode(:P_param6,'.CSV',
		lpad( NVL( TO_CHAR(cusag,  'FM9999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 8, ' ') ,
		lpad( NVL( TO_CHAR(cusag,  'FM999999.00'), ' '), 8, ' '))		CUSAG,				
	lpad( NVL( TO_CHAR(rcodsg), ' '), 7, '0')				RCODSG,
	decode(:P_param6,'.CSV',
		lpad (NVL (TO_CHAR(cout, 'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' '),
		lpad (NVL (TO_CHAR(cout, 'FM9999999999.00'), '0.00'), 13, ' '))	COUT,					
	rpad(NVL (verifsitu, ' '),3,' ')			VERIFSITU,
	rpad( NVL( factpid, ' '),  4,  ' ')			FACTPID,
	rpad( NVL( sgssii, ' '),  4,  ' ')			SGSSII,
	rpad(NVL( plocal, ' '),  20,  ' ')			PLOCAL,
	rpad(NVL(TO_CHAR(ca_dpg_ligne), ' '), 6, ' ')	CA_DPG_LIGNE,
	rpad(NVL(TO_CHAR(ca_dpg_ress), ' '), 6, ' ')	CA_DPG_RESS,
	rpad(NVL(metier, ' '), 3, ' ')			METIER,
	decode(:P_param6,'.CSV',
		lpad( NVL( TO_CHAR(couthtr,  'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' ') ,
		lpad( NVL( TO_CHAR(couthtr,  'FM9999999999.00'), '0.00'), 13, ' ')) COUTHTR,
rtype TYPE_RESSOURCE,
 rpad( NVL( mci, ' '),  5,  ' ')    MODE_CONTRACTUEL_INDICATIF,  	
	DECODE(:P_PARAM6,'.TXT',CHR(13),NULL)	CH
FROM (
	SELECT DISTINCT
		p.pid,
		p.factpty		ptype,
		p.factpno		pnom,
		p.factpdsg	pdsg,
		p.factpcm		pcmouvra, 
		p.cdeb,
		p.tires		tires, 
		p.aist		aist,
		p.rnom		rnom,
		s.soccode		soccode,
                                so.socgrpe		socgrpe,
                                pack_x_ressmoi.getCoutTTC ( s.soccode,r.rtype,to_number(TO_CHAR(p.cdeb,'YYYY')),l.metier,s.niveau,s.codsg,s.cout,TO_CHAR(p.cdeb,'DD/MM/YYYY'))  couttc,
		p.cusag		cusag,
		s.prestation	qualif,
		s.codsg		rcodsg,
		pack_x_ressmoi.getCout ( s.soccode,r.rtype,to_number(TO_CHAR(p.cdeb,'YYYY')),l.metier,s.niveau,s.codsg,s.cout) cout,
		decode(s.type_situ,'N','   ','ERR') verifsitu,               -- permet de différencier les réalisés par ressource sans situation
		p.factpid  		factpid,
		decode(s.soccode,'SG..','SG  ','SSII') sgssii,
		l.pzone 		plocal,
		si2.centractiv	ca_dpg_ligne,
		si1.centractiv	ca_dpg_ress,
		l.metier		metier,
                                pack_x_ressmoi.getCoutHTR ( s.soccode,r.rtype,to_number(TO_CHAR(p.cdeb,'YYYY')),l.metier,s.niveau,s.codsg,s.cout,TO_CHAR(p.cdeb,'DD/MM/YYYY'),si1.filcode)  couthtr,
                                r.rtype,
                                s.mode_contractuel_indicatif mci
	FROM		PROPLUS	p,
			LIGNE_BIP 	l,
			SITU_RESS_FULL s, 
			RESSOURCE 	r,
			STRUCT_INFO	si1,
			STRUCT_INFO	si2,
                                                APPLICATION         ap,
                                                PROJ_INFO             pi,
			DATDEBEX 	d,
                                                SOCIETE so
	WHERE 
		p.cusag     > 0
                                AND so.soccode=s.soccode
		AND p.factpid = l.pid	
		and to_char(p.cdeb,'YYYY')=to_char(d.datdebex,'YYYY')
		and p.cdeb<=d.moismens
		and r.ident=s.ident
		AND s.ident = p.tires
		AND (s.datdep >= p.cdeb OR s.datdep is null)
		AND (    ( (s.datsitu <= p.cdeb or s.datsitu is null )  AND  s.type_situ <> 'N' )
			  OR (s.datsitu <= p.cdeb AND  s.type_situ =  'N' ) )
  	                AND l.icpi = pi.icpi
  	                AND l.airt = ap.airt
		AND s.codsg = si1.codsg
		AND l.codsg = si2.codsg
                                &P_HAB
                                &P_WHERE
	) 
ORDER BY
		6  	asc,
		1	asc,
		2 	asc,
		3  	asc,
		7	asc,
		8  	asc
;]]>
      </select>
      <displayInfo x="1.05212" y="0.43750" width="0.69995" height="0.19995"/>
      <group name="G_PID">
        <displayInfo x="0.65552" y="1.02271" width="1.41797" height="4.36133"
        />
        <dataItem name="PID" datatype="vchar2" columnOrder="11" width="4"
         defaultWidth="30000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Pid">
          <xmlSettings xmlTag="&quot;ligne_origine&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pid , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="PID" order="1" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PTYPE" datatype="vchar2" columnOrder="12" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="1"
         defaultLabel="type">
          <xmlSettings xmlTag="&quot;type&quot;"/>
          <dataDescriptor
           expression="substr ( NVL ( ptype , &apos; &apos; ) , 1 , 1 )"
           descriptiveExpression="PTYPE" order="2" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PNOM" datatype="vchar2" columnOrder="13" width="30"
         defaultWidth="100000" defaultHeight="10000" columnFlags="1"
         defaultLabel="libellé">
          <xmlSettings xmlTag="&quot;libellé&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pnom , &apos; &apos; ) , 30 , &apos; &apos; )"
           descriptiveExpression="PNOM" order="3" width="30"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PDSG" datatype="vchar2" columnOrder="14" width="7"
         defaultWidth="60000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Pdsg" breakOrder="none">
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( pdsg ) , &apos; &apos; ) , 7 , &apos;0&apos; )"
           descriptiveExpression="PDSG" order="4" width="7"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PCMOUVRA" datatype="vchar2" columnOrder="15" width="5"
         defaultWidth="50000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Pcmouvra" breakOrder="none">
          <xmlSettings xmlTag="&quot;CodMo&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pcmouvra , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="PCMOUVRA" order="5" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CDEB" datatype="vchar2" columnOrder="16" width="6"
         defaultWidth="60000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Cdeb">
          <xmlSettings xmlTag="&quot;date&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( cdeb , &apos;MMYYYY&apos; ) , &apos;0&apos; ) , 6 , &apos;0&apos; )"
           descriptiveExpression="CDEB" order="6" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="TIRES" datatype="vchar2" columnOrder="17" width="5"
         defaultWidth="50000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Tires">
          <xmlSettings xmlTag="id_ress"/>
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( tires ) , &apos;0&apos; ) , 5 , &apos;0&apos; )"
           descriptiveExpression="TIRES" order="7" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="AIST" datatype="vchar2" columnOrder="18" width="6"
         defaultWidth="60000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Aist">
          <xmlSettings xmlTag="&quot;FFxxx&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( aist , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="AIST" order="8" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SOCCODE" datatype="vchar2" columnOrder="19" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Soccode" breakOrder="none">
          <xmlSettings xmlTag="&quot;Sté&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( soccode , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SOCCODE" order="9" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUTTC" datatype="vchar2" columnOrder="20" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Couttc" breakOrder="none">
          <xmlSettings xmlTag="&quot;cout_ttc&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( couttc , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( couttc , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUTTC" order="11" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CUSAG" datatype="vchar2" columnOrder="21" width="8"
         defaultWidth="80000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Cusag" breakOrder="none">
          <xmlSettings xmlTag="&quot;nb_jh&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( cusag , &apos;FM9999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 8 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( cusag , &apos;FM999999.00&apos; ) , &apos; &apos; ) , 8 , &apos; &apos; ) )"
           descriptiveExpression="CUSAG" order="12" width="8"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="RCODSG" datatype="vchar2" columnOrder="22" width="7"
         defaultWidth="60000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Rcodsg" breakOrder="none">
          <xmlSettings xmlTag="&quot;DPG_ress&quot;"/>
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( rcodsg ) , &apos; &apos; ) , 7 , &apos;0&apos; )"
           descriptiveExpression="RCODSG" order="13" width="7"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUT" datatype="vchar2" columnOrder="23" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Cout" breakOrder="none">
          <xmlSettings xmlTag="&quot;cout_ht&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( cout , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( cout , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUT" order="14" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="VERIFSITU" datatype="vchar2" columnOrder="24"
         width="3" defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Verifsitu" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( verifsitu , &apos; &apos; ) , 3 , &apos; &apos; )"
           descriptiveExpression="VERIFSITU" order="15" width="3"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="FACTPID" datatype="vchar2" columnOrder="25" width="4"
         defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Factpid" breakOrder="none">
          <xmlSettings xmlTag="&quot;imputation&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( factpid , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="FACTPID" order="16" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SGSSII" datatype="vchar2" columnOrder="26" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Sgssii" breakOrder="none">
          <xmlSettings xmlTag="&quot;societe&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( sgssii , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SGSSII" order="17" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PLOCAL" datatype="vchar2" columnOrder="27" width="20"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Plocal" breakOrder="none">
          <xmlSettings xmlTag="&quot;paramètre local&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( plocal , &apos; &apos; ) , 20 , &apos; &apos; )"
           descriptiveExpression="PLOCAL" order="18" width="20"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CA_DPG_LIGNE" datatype="vchar2" columnOrder="38"
         width="6" defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ca Dpg Ligne" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( ca_dpg_ligne ) , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="CA_DPG_LIGNE" order="19" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CA_DPG_RESS" datatype="vchar2" columnOrder="39"
         width="6" defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ca Dpg Ress" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( ca_dpg_ress ) , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="CA_DPG_RESS" order="20" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="METIER" datatype="vchar2" columnOrder="40" width="3"
         defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Metier" breakOrder="none">
          <xmlSettings xmlTag="&quot;Métier&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( metier , &apos; &apos; ) , 3 , &apos; &apos; )"
           descriptiveExpression="METIER" order="21" width="3"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUTHTR" datatype="vchar2" columnOrder="41" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Couthtr" breakOrder="none">
          <xmlSettings xmlTag="&quot;Coût htr&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( couthtr , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( couthtr , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUTHTR" order="22" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SOCGRPE" datatype="vchar2" columnOrder="49" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Socgrpe">
          <xmlSettings xmlTag="Groupe Sté"/>
          <dataDescriptor
           expression="rpad ( NVL ( socgrpe , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SOCGRPE" order="10" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="TYPE_RESSOURCE" datatype="character"
         oracleDatatype="aFixedChar" columnOrder="51" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Type Ressource" breakOrder="none">
          <dataDescriptor expression="rtype"
           descriptiveExpression="TYPE_RESSOURCE" order="23" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="MODE_CONTRACTUEL_INDICATIF" datatype="vchar2"
         columnOrder="50" width="5" defaultWidth="50000" defaultHeight="10000"
         columnFlags="0" defaultLabel="Mode Contractuel Indicatif"
         breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( mci , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="MODE_CONTRACTUEL_INDICATIF" order="24"
           width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CH" datatype="vchar2" columnOrder="37" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ch" breakOrder="none">
          <xmlSettings xmlTag=""/>
          <dataDescriptor
           expression="DECODE ( : P_PARAM6 , &apos;.TXT&apos; , CHR ( 13 ) , NULL )"
           descriptiveExpression="CH" order="25" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
      </group>
    </dataSource>
  </data>
  <layout>
  <section name="header">
    <body>
      <text name="B_PID1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.00000" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Pid]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PTYPE1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.31250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[type]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PNOM1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[libellé]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PDSG1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.06250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Pdsg]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PCMOUVRA1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.37500" y="0.00000" width="0.37500" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Pcmouvra]]>
          </string>
        </textSegment>
      </text>
      <text name="B_CDEB1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.87500" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cdeb]]>
          </string>
        </textSegment>
      </text>
      <text name="B_TIRES1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.18750" y="0.00000" width="0.25000" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Tires]]>
          </string>
        </textSegment>
      </text>
      <text name="B_AIST1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.56250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Aist]]>
          </string>
        </textSegment>
      </text>
      <text name="B_RNOM1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.87500" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Rnom]]>
          </string>
        </textSegment>
      </text>
      <text name="B_SOCCODE1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="3.18750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Soccode]]>
          </string>
        </textSegment>
      </text>
      <text name="B_COUTTC1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="3.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Couttc]]>
          </string>
        </textSegment>
      </text>
      <text name="B_CUSAG1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.06250" y="0.00000" width="0.25000" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cusag]]>
          </string>
        </textSegment>
      </text>
      <text name="B_QUALIF1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.43750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Qualif]]>
          </string>
        </textSegment>
      </text>
      <text name="B_RCODSG1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.87500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Rcodsg]]>
          </string>
        </textSegment>
      </text>
      <text name="B_COUT1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="5.31250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cout]]>
          </string>
        </textSegment>
      </text>
      <text name="B_VERIFSITU1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="5.62500" y="0.00000" width="0.43750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Verifsitu]]>
          </string>
        </textSegment>
      </text>
      <text name="B_FACTPID1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="6.18750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Factpid]]>
          </string>
        </textSegment>
      </text>
      <text name="B_SGSSII1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="6.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Sgssii]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PLOCAL1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="7.06250" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Plocal]]>
          </string>
        </textSegment>
      </text>
    </body>
  </section>
  <section name="main">
    <body>
      <frame name="M_G_PID_GRPFR">
        <geometryInfo x="0.00000" y="0.00000" width="6.75000" height="0.25000"
        />
        <generalLayout verticalElasticity="variable"/>
        <repeatingFrame name="R_G_PID" source="G_PID" printDirection="down"
         minWidowRecords="1" columnMode="no">
          <geometryInfo x="0.00000" y="0.12500" width="6.75000"
           height="0.12500"/>
          <generalLayout verticalElasticity="expand"/>
          <field name="F_PID" source="PID" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="0.00000" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PTYPE" source="PTYPE" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="0.18750" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PNOM" source="PNOM" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="0.37500" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PDSG" source="PDSG" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="0.68750" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PCMOUVRA" source="PCMOUVRA" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="0.87500" y="0.12500" width="0.37500"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CDEB" source="CDEB" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="1.25000" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_TIRES" source="TIRES" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="1.43750" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_AIST" source="AIST" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="1.68750" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_SOCCODE" source="SOCCODE" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="1.87500" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUTTC" source="COUTTC" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="2.18750" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CUSAG" source="CUSAG" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="2.50000" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_RCODSG" source="RCODSG" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="2.75000" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUT" source="COUT" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="3.06250" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_VERIFSITU" source="VERIFSITU" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="3.25000" y="0.12500" width="0.43750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_FACTPID" source="FACTPID" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="3.68750" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_SGSSII" source="SGSSII" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="4.00000" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PLOCAL" source="PLOCAL" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="4.31250" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CH" source="CH" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="4.62500" y="0.12500" width="0.12500"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CA_DPG_LIGNE" source="CA_DPG_LIGNE" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="4.75000" y="0.12500" width="0.56250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CA_DPG_RESS" source="CA_DPG_RESS" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="5.31250" y="0.12500" width="0.50000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_METIER" source="METIER" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="5.81250" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUTHTR" source="COUTHTR" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="6.12500" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_SOCGRPE" source="SOCGRPE" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="5"/>
            <geometryInfo x="6.43750" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
        </repeatingFrame>
        <frame name="M_G_PID_HDR">
          <geometryInfo x="0.00000" y="0.00000" width="6.75000"
           height="0.12500"/>
          <advancedLayout printObjectOnPage="allPage"
           basePrintingOn="anchoringObject"/>
          <text name="B_PID" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.00000" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Pid]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PTYPE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.18750" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[type]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PNOM" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.37500" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[libellé]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PDSG" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.68750" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Pdsg]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PCMOUVRA" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.87500" y="0.00000" width="0.37500"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Pcmouvra]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CDEB" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.25000" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Cdeb]]>
              </string>
            </textSegment>
          </text>
          <text name="B_TIRES" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.43750" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Tires]]>
              </string>
            </textSegment>
          </text>
          <text name="B_AIST" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.68750" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Aist]]>
              </string>
            </textSegment>
          </text>
          <text name="B_SOCCODE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.87500" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Soccode]]>
              </string>
            </textSegment>
          </text>
          <text name="B_COUTTC" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.18750" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Couttc]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CUSAG" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.50000" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Cusag]]>
              </string>
            </textSegment>
          </text>
          <text name="B_RCODSG" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.75000" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Rcodsg]]>
              </string>
            </textSegment>
          </text>
          <text name="B_COUT" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.06250" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Cout]]>
              </string>
            </textSegment>
          </text>
          <text name="B_VERIFSITU" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.25000" y="0.00000" width="0.43750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Verifsitu]]>
              </string>
            </textSegment>
          </text>
          <text name="B_FACTPID" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.68750" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Factpid]]>
              </string>
            </textSegment>
          </text>
          <text name="B_SGSSII" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.00000" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Sgssii]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PLOCAL" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.31250" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Plocal]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CH" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.62500" y="0.00000" width="0.12500"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Ch]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CA_DPG_LIGNE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.75000" y="0.00000" width="0.56250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Ca Dpg Ligne]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CA_DPG_RESS" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="5.31250" y="0.00000" width="0.50000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Ca Dpg Ress]]>
              </string>
            </textSegment>
          </text>
          <text name="B_METIER" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="5.81250" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Metier]]>
              </string>
            </textSegment>
          </text>
          <text name="B_COUTHTR" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="6.12500" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Couthtr]]>
              </string>
            </textSegment>
          </text>
          <text name="B_SOCGRPE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="6.43750" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="5"/>
              <string>
              <![CDATA[Socgrpe]]>
              </string>
            </textSegment>
          </text>
        </frame>
      </frame>
    </body>
  </section>
  </layout>
  <parameterForm>
  <text name="PB_1" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="1.32129" y="0.15979" width="1.38513" height="0.22205"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="12" bold="yes"/>
      <string>
      <![CDATA[Paramètres état]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_2" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.77441" y="0.49304" width="2.47888" height="0.18042"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="10" bold="yes"/>
      <string>
      <![CDATA[Entrer les valeurs des paramètres]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_param6" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="0.82629" width="0.60388" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param6]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_global" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.15955" width="0.54138" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Global]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_param7" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.49280" width="1.22559" height="0.25720"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param7:Code DPG]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_P_param6" source="P_param6" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="0.78430" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_P_global" source="P_global" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.11755" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_P_param7" source="P_param7" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.45081" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_3" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.87427" width="0.60388" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param8]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_P_param8" source="P_PARAM8" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.83228" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_4" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.20142" y="2.23743" width="0.92358" height="0.18970"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Desformat]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_1" source="DESTYPE" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="2.20581" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  </parameterForm>
  <programUnits>
    <function name="afterpform">
      <textSource>
      <![CDATA[function AfterPForm return boolean is
   l_param   VARCHAR2(40);
begin
	
	-- Initialisation des paramètres	  
  :P_habili_DP := '';
  :P_habili_P  := '';
  :P_habili_A  :='';
  :P_habili_CAFI  :='';
 	:P_PERIME:='';
	:P_HAB := 'VIDE';
	:P_WHERE := '';   	
  
   -- Teste si on a été lancé par le menu habilitation par référentiels
	IF :P_PARAM8='REF' THEN
  
	   -- Informations pour l'habilitation par référentiels
		:P_habili_DP := pack_global.lire_doss_proj(:P_GLOBAL);
	  :P_habili_P  := pack_global.lire_projet(:P_GLOBAL);
	  :P_habili_A  := pack_global.lire_appli(:P_GLOBAL);
	  :P_habili_CAFI  := pack_global.lire_ca_fi(:P_GLOBAL);

	  IF (:P_habili_DP is null or :P_habili_DP='') THEN
			  :P_habili_DP := 'VIDE';
	  END IF;	
	  IF (:P_habili_P is null or :P_habili_P='') THEN
			  :P_habili_P := 'VIDE';
	  END IF;	
	  IF (:P_habili_A is null or :P_habili_A='') THEN
			  :P_habili_A := 'VIDE';
	  END IF;	
	  IF (:P_habili_CAFI is null or :P_habili_CAFI='') THEN
			  :P_habili_CAFI := 'VIDE';
	  END IF;	
  
		--srw.message(1,:P_habili_DP);
		--srw.message(1,:P_habili_P);
		--srw.message(1,:P_habili_A);
		--srw.message(1,:P_habili_CAFI);
  	
	  -- Si on a une valeur (dossier projet , projet , application ) égale à TOUS - on ne fait aucune Restriction sur ces 3 valeurs
	  IF (:P_habili_DP='TOUS' or :P_habili_P='TOUS' or :P_habili_A='TOUS' )THEN
  		:P_HAB := '';
  	ELSE	

		  IF (:P_habili_DP<>'VIDE')THEN
			  :P_HAB := ' l.dpcode in ('||:P_habili_DP||') ';
		  END IF;		
		  -- Projet demandé
		  -- On fait aussi le contrôle que sur le projet principal (icpir)
		  IF (:P_habili_P<>'VIDE') THEN
		  		IF (:P_HAB<>'VIDE') THEN  	
		  			:P_HAB := :P_HAB 	||' OR ' ;
		  		ELSE
		  			:P_HAB := '' ;
		  		END IF;	
					:P_HAB := :P_HAB ||' (INSTR('''||:P_habili_P||''', l.icpi) > 0) ';		  
		  END IF;
										
			-- Application demandée
		  -- On fait aussi le contrôle sur l'application principale
		  IF (:P_habili_A<>'VIDE') THEN
			  	IF (:P_HAB<>'VIDE') THEN  	
			  		:P_HAB := :P_HAB 	||' OR ' ;
		  		ELSE
		  			:P_HAB := '' ;
			  	END IF;	
			 	  :P_HAB := :P_HAB ||' (INSTR('''||:P_habili_A||''', l.airt) > 0) ' ; 
		  END IF;
		  
		  -- On rajoute le 'AND devant P_HAB
	  	IF (:P_HAB<>'VIDE') THEN  	
		  		:P_HAB := ' AND ( ' || :P_HAB || ' ) ' ;
	  	END IF;	
  	END IF;  

		-- On remet PHAB à blanc  	
  	IF (:P_HAB='VIDE') THEN  	
	  		:P_HAB := '' ;
  	END IF;	

  	-- On rajoute la restriction sur le CAFI
		IF (:P_habili_CAFI<>'VIDE' and :P_habili_CAFI<>'TOUS')
			THEN
  		:P_HAB := :P_HAB ||' AND s.CODSG IN (select codsg from struct_info 
  						     												 where CENTRACTIV IN
  						     												 (
  						        		 									SELECT codcamo FROM centre_activite 
  						           		 								WHERE codcamo IN ('||:P_habili_CAFI||')
  						           												OR CANIV1 IN ('||:P_habili_CAFI||')
  						           												OR CANIV2 IN ('||:P_habili_CAFI||')
  						           												OR CANIV3 IN ('||:P_habili_CAFI||')
  						           												OR CANIV4 IN ('||:P_habili_CAFI||')
  						           												OR CANIV5 IN ('||:P_habili_CAFI||')
  						           												OR CANIV6 IN ('||:P_habili_CAFI||')  
										  						     		 )
  						    												)';
		END IF ;	  	
 		
  	
	-- Le traitment n'a pas été lancé par le menu referentiel (il a pu été lancé par exemple par le menu administration )	
  ELSE 
	   -- Informations pour le lancement par les autres menus 	
		:P_PERIME:=pack_global.lire_perime(:P_GLOBAL);
		:P_HAB := '';

  	:P_WHERE :=' AND ((s.codsg IN (SELECT codsg FROM vue_dpg_perime where INSTR('''||:P_PERIME||''', codbddpg) > 0 ))'; 
  	:P_WHERE :=:P_WHERE ||' OR (p.factpdsg IN (SELECT codsg FROM vue_dpg_perime where INSTR('''||:P_PERIME||''', codbddpg) > 0 )))'; 

	  -- Interprétation du code DPG ( param7)
    -- ================================================
    IF NVL(LENGTH(LPAD(:P_PARAM7, 7, '0')), 0)!= 0 THEN
      --  l_param := rtrim(rtrim(LPAD(:P_PARAM7, 7, '0'),'0')) ;
                                                                
       --  Fiche 490 : mise en place  prise en compte des '*' , les doubles '0' sont remplacés déjà dans la JSP
       --              via l'appel à la function JS 'Replace_DoubleZero_by_DoubleEtoile' (voir xRessmoisAd.jsp)                                                        
   
      	/*if LPAD(:P_PARAM7, 7, '*') = '*******' then
						l_param := '';
				else
					if substr(LPAD(:P_PARAM7, 7, '0'),4,4)='****' then
						l_param := substr(LPAD(:P_PARAM7, 7, '0'),1,3);
					else
						if substr(LPAD(:P_PARAM7, 7, '0'),6,2)='**' then
								l_param := substr(LPAD(:P_PARAM7, 7, '0'),1,5);
						else
								l_param := LPAD(:P_PARAM7, 7, '0');
					  end if;
					end if;
				end if;	*/
				
			 if LPAD(:P_PARAM7, 7, '0') = '0000000' then
						l_param := '';
				else
					if substr(LPAD(:P_PARAM7, 7, '0'),4,4)='0000' then
						l_param := substr(LPAD(:P_PARAM7, 7, '0'),1,3);
					else
						if substr(LPAD(:P_PARAM7, 7, '0'),6,2)='00' then
								l_param := substr(LPAD(:P_PARAM7, 7, '0'),1,5);
						else
								l_param := LPAD(:P_PARAM7, 7, '0');
					  end if;
					end if;
				end if;	 
				
	      --	:p_where := 'and  to_char(sit.codsg,''FM0000000'') like ''' || l_codsg ||'%'' '; 
        --l_param := LPAD(:P_PARAM7, 7, '0') ;
      
				:P_WHERE := :P_WHERE || ' AND ( TO_CHAR(s.codsg, ''FM0000000'') like ''' || l_param ||'%'' ';
				:P_WHERE := :P_WHERE || '     OR  TO_CHAR(p.factpdsg, ''FM0000000'') like ''' || l_param ||'%'' )';
				
				
		END IF;

	  --srw.message(1,:P_WHERE);
	END IF;		

  return (TRUE);
end;]]>
      </textSource>
    </function>
  </programUnits>
  <webSource>
  <![CDATA[<%@ taglib uri="/WEB-INF/lib/reports_tld.jar" prefix="rw" %> 
<%@ page language="java" import="java.io.*" errorPage="/rwerror.jsp" session="false" %>
<%@ page contentType="text/html;charset=ISO-8859-1" %>
<!--
<rw:report id="report"> 
<rw:objects id="objects">
</rw:objects>
-->

<html>

<head>
<meta name="GENERATOR" content="Oracle 9i Reports Developer"/>
<title> Your Title </title>

<rw:style id="yourStyle">
   <!-- Report Wizard inserts style link clause here -->
</rw:style>

</head>


<body>

<rw:dataArea id="yourDataArea">
   <!-- Report Wizard inserts the default jsp here -->
</rw:dataArea>



</body>
</html>

<!--
</rw:report> 
-->
]]>
  </webSource>
  <reportPrivate defaultReportType="tabular" versionFlags2="0" templateName=""
  />
  <reportWebSettings>
  <![CDATA[#NULL#]]>
  </reportWebSettings>
</report>