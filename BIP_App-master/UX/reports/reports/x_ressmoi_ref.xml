<?xml version="1.0" encoding="WINDOWS-1252" ?>
<report name="x_ressmoi_ref" DTDVersion="9.0.2.0.10"
 afterParameterFormTrigger="afterpform">
  <xmlSettings xmlTag="X_RESSMOI_REF" xmlPrologType="text">
  <![CDATA[<?xml version="1.0"?>]]>
  </xmlSettings>
  <reportHtmlEscapes>
    <beforeReportHtmlEscape>
    <![CDATA[<html>
<body dir=&Direction bgcolor="#ffffff">
]]>
    </beforeReportHtmlEscape>
    <beforePageHtmlEscape>
    <![CDATA[#NULL#]]>
    </beforePageHtmlEscape>
    <afterPageHtmlEscape>
    <![CDATA[<hr size=5 noshade>
]]>
    </afterPageHtmlEscape>
    <beforeFormHtmlEscape>
    <![CDATA[<html>
<body dir=&Direction bgcolor="#ffffff">
<form method=post action="_action_">
<input name="hidden_run_parameters" type=hidden value="_hidden_">
<font color=red><!--error--></font>
<center>
<p><table border=0 cellspacing=0 cellpadding=0>
<tr>
<td><input type=submit></td>
<td width=15>
<td><input type=reset></td>
</tr>
</table>
<p><hr><p>
]]>
    </beforeFormHtmlEscape>
    <pageNavigationHtmlEscape>
    <![CDATA[<HTML>
<TITLE>Oracle HTML Navigator</TITLE>
<HEAD>
<SCRIPT LANGUAGE = "JavaScript">

var jump_index = 1			// Jump to this page
var num_pages = &TotalPages			// Total number of pages
var basefilename = "&file_name"		// Base file name
var fileext = "&file_ext"		//File extension

/* jumps to "new_page" */
function new_page(form, new_page)
{
	form.reqpage.value = new_page;
	parent.frames[0].location = basefilename + "_" + new_page + "."+fileext;
}

/* go back one page */
function back(form)
{
	/* if we are not in first page */
	if (jump_index > 1)
	{
		jump_index--;
		new_page(form, jump_index);
	}
}

/* go forward one page */
function forward(form)
{
	/* if we are not in last page */
	if (jump_index < num_pages)
	{
		jump_index++;
		new_page(form, jump_index);
	}
}

/* go to first page */
function first(form)
{
	if(jump_index != 1)
	{
		jump_index = 1;
		new_page(form, jump_index);
	}
}

/* go to last page */
function last(form)
{
	if(jump_index != num_pages)
	{
		jump_index = num_pages;
		new_page(form, jump_index);
	}
}

/* go to the user specified page number */
function pagenum(form)
{
	/* sanity check */
	if (form.reqpage.value < 1)
	{
		form.reqpage.value = 1;
	}
	if (form.reqpage.value > num_pages)
	{
		form.reqpage.value = num_pages;
	}
	jump_index = form.reqpage.value;
	new_page(form, jump_index);
}
</SCRIPT>
</HEAD>

<BODY>
<FORM NAME="ThisForm" onSubmit="pagenum(this); return false;">
<center><table><tr>
<td> <INPUT TYPE="button"  VALUE="<< " onClick="first(this.form)">
<td> <INPUT TYPE="button"  VALUE=" < " onClick="back(this.form)">
<td> <INPUT TYPE="button"  VALUE="Page:" onClick="pagenum(this.form)">
<td> <INPUT NAME="reqpage" VALUE="1" SIZE=2>
<td> <INPUT TYPE="button"  VALUE=" > " onClick="forward(this.form)">
<td> <INPUT TYPE="button"  VALUE=" >>" onClick="last(this.form)">
</table></center>
</FORM></BODY>
</HTML>
]]>
    </pageNavigationHtmlEscape>
  </reportHtmlEscapes>
  <data>
    <userParameter name="P_global" datatype="character" width="5024"
     precision="10"
     initialValue="X106223;REF;22560;0161614;01 ;00000000000;000000000;0;04707;;;;;;ges,cli,isac,ginv,act,fin,supach,acdet,fidet,admin,copi;17954;dir,me,mo,isacm,inv,ach,suiviact,rbip,ref,ore,req;34164,37408;031010020,031911000&apos; delimited_hdr=&apos;yes&apos; module=&apos;/applis/bipd/weblogic/dom922dev/servers/bipSrv/data/reports/x_ressmoi_ref.rdf"
     label="P Global" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param7" datatype="character" width="7"
     precision="10" initialValue="0161614" label="P Param7" defaultWidth="0"
     defaultHeight="0">
      <comment>
      <![CDATA[Code DPG]]>
      </comment>
    </userParameter>
    <userParameter name="P_perime" datatype="character" width="5024"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param1" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param2" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param3" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param4" datatype="character" precision="10"
     defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_param5" datatype="character" width="50"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_WHERE" datatype="character" width="20000"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM8" datatype="character" precision="10"
     initialValue="REF" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_A" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_DP" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_P" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_CAFI" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HAB" datatype="character" width="2048"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM13" datatype="character" precision="10"
     initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM10" datatype="character" precision="10"
     initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM11" datatype="character" precision="10"
     initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_CADA" datatype="character" width="5000"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM9" datatype="character" precision="10"
     initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_APPLI" datatype="character" width="5000"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_HABILI_CA_PAYEUR" datatype="character" width="5000"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM12" datatype="character" precision="10"
     initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM6" datatype="character" precision="10"
     initialValue=".CVS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM14" datatype="character" width="5000"
     precision="10" initialValue="TOUS" defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PARAM0" datatype="character" precision="10"
     defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_PERIM_CAFI" datatype="character" width="5000"
     defaultWidth="0" defaultHeight="0"/>
    <userParameter name="P_SMENUS_GES" datatype="character" width="2000"
     precision="10" defaultWidth="0" defaultHeight="0"/>
    <systemParameter name="MODE" initialValue="Default"/>
    <systemParameter name="ORIENTATION" initialValue="Default"/>
    <dataSource name="Q_1">
      <select>
      <![CDATA[-- X_RESSMOI_REF maj : 14/03/2012
-- Crée le 20/08/2003 par NBM
--Toutes les ressources du DPG choisi mois par mois du début de l'année jusqu'au mois courant-1 (datdebex.moismens-1)
--Pour chaque mois, on veut la ligne BIP de la ressource et son consommé.
-- BSA 26/03/2012 : ajout de la colonne PROFIL_FI_MENS ( base sur l'historisation )

SELECT rpad( NVL( pid, ' '),  4,  ' ')                     PID,
    substr( NVL( ptype, ' '), 1, 1)                      PTYPE,
    rpad( NVL( pnom, ' '), 30, ' ')                    PNOM,
    lpad( NVL( TO_CHAR(DPG_ligne), ' '), 7, '0')                DPG_ligne,
    rpad( NVL( pcmouvra, ' '), 5, ' ')                PCMOUVRA,
    rpad( NVL( TO_CHAR(cdeb, 'MMYYYY'), '0'), 6, '0')         CDEB,
    lpad( NVL( TO_CHAR(tires), '0'), 5, '0')                TIRES,
    rpad( NVL( aist, ' '), 6, ' ')                    AIST,
                
DECODE(:P_PARAM0,'fournisseur', 
                             DECODE( pack_habilitation.isDpgMe(rcodsg,:P_PERIME), 'O', 
                                        RPAD( NVL(rnom,' '),30,' '),
                                        DECODE(  pack_habilitation.isPerimCafi(CAFI,:P_PERIM_CAFI) ,'N',
                                                RPAD(' ',30,' ')
                                                ,RPAD( NVL(rnom,' '),30,' ') ) )
                         , ' ' ) RNOM,
    
    rpad( NVL( soccode, ' '), 4, ' ')                    SOCCODE,
                rpad( NVL( socgrpe, ' '), 4, ' ')                    SOCGRPE,
    decode(:P_param6,'.CSV',
        lpad( NVL( TO_CHAR(couttc,  'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' ') ,
        lpad( NVL( TO_CHAR(couttc,  'FM9999999999.00'), '0.00'), 13, ' '))    COUTTC,
    decode(:P_param6,'.CSV',
        lpad( NVL( TO_CHAR(cusag,  'FM9999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 8, ' ') ,
        lpad( NVL( TO_CHAR(cusag,  'FM999999.00'), ' '), 8, ' '))        CUSAG,

                NVL( qualif, '   ')                      QUALIF, 
                
    lpad( NVL( TO_CHAR(rcodsg), ' '), 7, '0')                RCODSG,
    decode(:P_param6,'.CSV',
        lpad (NVL (TO_CHAR(cout, 'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' '),
        lpad (NVL (TO_CHAR(cout, 'FM9999999999.00'), '0.00'), 13, ' '))    COUT,                    
    rpad(NVL (verifsitu, ' '),3,' ')            VERIFSITU,
    rpad( NVL( factpid, ' '),  4,  ' ')            FACTPID,
    rpad( NVL( sgssii, ' '),  4,  ' ')            SGSSII,
    rpad(NVL( plocal, ' '),  20,  ' ')            PLOCAL,
    rpad(NVL(TO_CHAR(ca_dpg_ligne), ' '), 6, ' ')    CA_DPG_LIGNE,
    rpad(NVL(TO_CHAR(ca_dpg_ress), ' '), 6, ' ')    CA_DPG_RESS,
    rpad(NVL(metier, ' '), 3, ' ')            METIER,
    decode(:P_param6,'.CSV',
        lpad( NVL( TO_CHAR(couthtr,  'FM9999999990D00','NLS_NUMERIC_CHARACTERS='',.'), '0'), 13, ' ') ,
        lpad( NVL( TO_CHAR(couthtr,  'FM9999999999.00'), '0.00'), 13, ' ')) COUTHTR,
                 rtype TYPE_RESSOURCE,
                 rpad( NVL( mci, ' '),  5,  ' ')    MODE_CONTRACTUEL_INDICATIF,      
    DECODE(:P_PARAM6,'.TXT',CHR(13),NULL)    CH,
 
RPAD(
DECODE(:P_PARAM0,'fournisseur', 
                             DECODE( pack_habilitation.isDpgMe(rcodsg,:P_PERIME), 'O', 
                                     DECODE(:P_SMENUS_GES,'O', 
                                            NVL( PROFIL_FI_DYNA, ' ')
                                            ,' '  
                                          )   ,
                                     DECODE( pack_habilitation.isPerimCafi(CAFI,:P_PERIM_CAFI) ,'N',
                                            ' '
                                            , DECODE(:P_SMENUS_GES,'O', 
                                                      NVL( PROFIL_FI_DYNA, ' ')
                                                      ,' '  
                                                    )      
                                           ) 
                                   )
                         , ' ' ),
12, ' ')  PROFIL_FI_DYNA,

DECODE(:P_PARAM0,'fournisseur', 
                             DECODE( pack_habilitation.isDpgMe(rcodsg,:P_PERIME), 'O', 
                                        DECODE(:P_SMENUS_GES,'O', 
                                                NVL( PROFIL_FI_MENS, ' ')
                                                ,' '  
                                              )   ,
                                        DECODE( pack_habilitation.isPerimCafi(CAFI,:P_PERIM_CAFI) ,'N',
                                                 ' '
                                                 ,  DECODE(:P_SMENUS_GES,'O', 
                                                            NVL( PROFIL_FI_MENS, ' ')
                                                            ,' '  
                                                          )      
                                               ) 
                                   )
                         , ' ' ) PROFIL_FI_MENS,
 
RPAD(NVL(DPCODE,0),5,0)  DPCODE,
RPAD(  NVL(CODE_PROJET,' ' ), 5 ,' ')    CODE_PROJET,
RPAD(  NVL(CODE_APPLICATION,' ' ), 5 ,' ')    CODE_APPLICATION,
LPAD(  NVL(CAFI,0 ), 6 ,0)       CAFIRess,
LPAD(  NVL(CA_PAYEUR,0 ), 6 ,0)  CA_PAYEUR,
LPAD(  NVL(CADA,0 ), 6 ,0)  CADA,
--Ajout dans le cadre de la PPM 62334 paragraphe 6.9 par FAD
decode(:P_param6,'.CSV', DECODE ( DPCOPIAXEMETIER , NULL ,( DECODE ( PROJAXEMETIER , NULL , ' ' , PROJAXEMETIER ) ) , DPCOPIAXEMETIER ) , rpad ( DECODE ( DPCOPIAXEMETIER , NULL ,( DECODE ( PROJAXEMETIER , NULL , ' ' , PROJAXEMETIER ) ) , DPCOPIAXEMETIER ) , 12 , ' ' ) ) Ref_demande,

decode(:P_param6,'.CSV', DECODE ( DPCOPIAXEMETIER , NULL ,( DECODE ( PROJAXEMETIER , NULL , ' ' , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) , NULL , '???' , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) ) ) ) , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) , NULL , '???' , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) ) ) , rpad ( DECODE ( DPCOPIAXEMETIER , NULL ,( DECODE ( PROJAXEMETIER , NULL , ' ' , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) , NULL , '???' , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) ) ) ) , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) , NULL , '???' , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) ) ) , 80 , ' ' ) ) Ref_demande_Lib,

decode(:P_param6,'.CSV', DPCOPIAXEMETIER , rpad ( NVL ( DPCOPIAXEMETIER , ' ' ) , 12 , ' ' ) ) DpCopiAxeMetier,

decode(:P_param6,'.CSV', PROJAXEMETIER , rpad ( NVL ( PROJAXEMETIER , ' ' ) , 12 , ' ' ) )  ProjAxeMetier

--Fin
FROM (
    SELECT DISTINCT
        p.pid,
        p.factpty        ptype,
        p.factpno        pnom,
        p.factpdsg    dpg_ligne,
        p.factpcm        pcmouvra, 
        p.cdeb,
        p.tires        tires, 
        p.aist        aist,
        p.rnom        rnom,
        s.soccode        soccode,
                                so.socgrpe        socgrpe,
                                
        pack_x_ressmoi.getCoutTTC ( s.soccode, r.rtype, l.metier, s.niveau, s.codsg, si1.CAFI, s.cout, s.PRESTATION, r.ident, TO_CHAR(p.cdeb,'DDMMYYYY') , l.CODCAMO)  couttc,
        
        p.cusag        cusag,
        s.prestation    qualif,
        s.codsg        rcodsg,
        
        pack_x_ressmoi.getCout ( s.soccode,r.rtype,l.metier,s.niveau,s.codsg, si1.CAFI , s.cout,s.PRESTATION, r.ident, TO_CHAR(p.cdeb,'DDMMYYYY') , l.CODCAMO) cout,    
   
        decode(s.type_situ,'N','   ','ERR') verifsitu,               -- permet de différencier les réalisés par ressource sans situation
        p.factpid          factpid,
        decode(s.soccode,'SG..','SG  ','SSII') sgssii,
        l.pzone         plocal,
        si2.centractiv    ca_dpg_ligne,
        si1.centractiv    ca_dpg_ress,
        l.metier        metier,
        
        pack_x_ressmoi.getCoutHTR ( s.soccode,r.rtype,l.metier,s.niveau,s.codsg, si1.CAFI ,s.cout,s.PRESTATION, r.ident, TO_CHAR(p.cdeb,'DDMMYYYY'), si1.filcode, l.CODCAMO)  couthtr,

        r.rtype rtype,
        s.mode_contractuel_indicatif mci,

        pack_utile_cout.Get_Profil_Fi( s.codsg, si1.CAFI, s.PRESTATION, r.ident, TO_CHAR(p.cdeb,'DDMMYYYY'), s.soccode, r.rtype, l.metier, s.niveau, l.codcamo,l.pid ) PROFIL_FI_DYNA,
        decode(l.codcamo,66666,'multiCA',PACK_UTILE_COUT.GET_PROFIL_FI_MENS(r.ident, p.cdeb , p.pid)) PROFIL_FI_MENS,

        si1.CAFI    CAFI,
        l.DPCODE DPCODE,
        l.ICPI   CODE_PROJET,
        l.AIRT   CODE_APPLICATION,
        l.CODCAMO CA_PAYEUR,
        pi.CADA  CADA,
		DPCOPI.DPCOPIAXEMETIER,
		PI.PROJAXEMETIER
        
    FROM    PROPLUS    p,
            LIGNE_BIP     l,
            SITU_RESS_FULL s, 
            RESSOURCE     r,
            STRUCT_INFO    si1,
            STRUCT_INFO    si2,
            APPLICATION    ap,
            PROJ_INFO      pi,
            DATDEBEX       d,
            SOCIETE so,
			DOSSIER_PROJET_COPI DPCOPI

    WHERE 1=1
		AND PI.dp_copi = DPCOPI.dp_copi(+)
        AND p.cusag     > 0
                                AND so.soccode=s.soccode
        AND p.factpid = l.pid    
        and to_char(p.cdeb,'YYYY')=to_char(d.datdebex,'YYYY')
        and p.cdeb<=d.moismens
        and r.ident=s.ident
        AND s.ident = p.tires
        AND (s.datdep >= p.cdeb OR s.datdep is null)
        AND (    ( (s.datsitu <= p.cdeb or s.datsitu is null )  AND  s.type_situ <> 'N' )
              OR (s.datsitu <= p.cdeb AND  s.type_situ =  'N' ) )
                      AND l.icpi = pi.icpi
                      AND l.airt = ap.airt
        AND s.codsg = si1.codsg
        AND l.codsg = si2.codsg
 &P_HAB
 &P_WHERE
    ) 
ORDER BY
        6      asc,
        1    asc,
        2     asc,
        3      asc,
        7    asc,
        8      asc
;]]>
      </select>
      <displayInfo x="1.05212" y="0.43750" width="0.69995" height="0.19995"/>
      <group name="G_PID">
        <displayInfo x="0.88464" y="1.49133" width="2.30286" height="6.24121"
        />
        <dataItem name="PID" datatype="vchar2" columnOrder="11" width="4"
         defaultWidth="30000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Pid">
          <xmlSettings xmlTag="&quot;ligne_origine&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pid , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="PID" order="1" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PTYPE" datatype="vchar2" columnOrder="12" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="1"
         defaultLabel="type">
          <xmlSettings xmlTag="&quot;type&quot;"/>
          <dataDescriptor
           expression="substr ( NVL ( ptype , &apos; &apos; ) , 1 , 1 )"
           descriptiveExpression="PTYPE" order="2" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PNOM" datatype="vchar2" columnOrder="13" width="30"
         defaultWidth="100000" defaultHeight="10000" columnFlags="1"
         defaultLabel="libellé">
          <xmlSettings xmlTag="&quot;libellé&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pnom , &apos; &apos; ) , 30 , &apos; &apos; )"
           descriptiveExpression="PNOM" order="3" width="30"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="DPG_ligne" datatype="vchar2" columnOrder="14" width="7"
         defaultWidth="60000" defaultHeight="10000" columnFlags="0"
         defaultLabel="DPG_ligne" breakOrder="none">
		 <xmlSettings xmlTag="&quot;DPG_ligne&quot;"/>
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( DPG_ligne ) , &apos; &apos; ) , 7 , &apos;0&apos; )"
           descriptiveExpression="DPG_ligne" order="4" width="7"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PCMOUVRA" datatype="vchar2" columnOrder="15" width="5"
         defaultWidth="50000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Pcmouvra" breakOrder="none">
          <xmlSettings xmlTag="&quot;CodMo&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( pcmouvra , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="PCMOUVRA" order="5" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CDEB" datatype="vchar2" columnOrder="16" width="6"
         defaultWidth="60000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Cdeb">
          <xmlSettings xmlTag="&quot;date&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( cdeb , &apos;MMYYYY&apos; ) , &apos;0&apos; ) , 6 , &apos;0&apos; )"
           descriptiveExpression="CDEB" order="6" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="TIRES" datatype="vchar2" columnOrder="17" width="5"
         defaultWidth="50000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Tires">
          <xmlSettings xmlTag="id_ress"/>
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( tires ) , &apos;0&apos; ) , 5 , &apos;0&apos; )"
           descriptiveExpression="TIRES" order="7" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="AIST" datatype="vchar2" columnOrder="18" width="6"
         defaultWidth="60000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Aist">
          <xmlSettings xmlTag="&quot;FFxxx&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( aist , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="AIST" order="8" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="RNOM" datatype="vchar2" columnOrder="62" width="30"
         defaultWidth="100000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Rnom">
          <xmlSettings xmlTag="Nom_ress"/>
          <dataDescriptor
           expression="DECODE ( : P_PARAM0 , &apos;fournisseur&apos; , DECODE ( pack_habilitation.isDpgMe ( rcodsg , : P_PERIME ) , &apos;O&apos; , RPAD ( NVL ( rnom , &apos; &apos; ) , 30 , &apos; &apos; ) , DECODE ( pack_habilitation.isPerimCafi ( CAFI , : P_PERIM_CAFI ) , &apos;N&apos; , RPAD ( &apos; &apos; , 30 , &apos; &apos; ) , RPAD ( NVL ( rnom , &apos; &apos; ) , 30 , &apos; &apos; ) ) ) , &apos; &apos; )"
           descriptiveExpression="RNOM" order="9" width="30"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SOCCODE" datatype="vchar2" columnOrder="19" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Soccode" breakOrder="none">
          <xmlSettings xmlTag="&quot;Sté&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( soccode , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SOCCODE" order="10" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUTTC" datatype="vchar2" columnOrder="20" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Couttc" breakOrder="none">
          <xmlSettings xmlTag="&quot;cout_ttc&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( couttc , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( couttc , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUTTC" order="12" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CUSAG" datatype="vchar2" columnOrder="21" width="8"
         defaultWidth="80000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Cusag" breakOrder="none">
          <xmlSettings xmlTag="&quot;nb_jh&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( cusag , &apos;FM9999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 8 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( cusag , &apos;FM999999.00&apos; ) , &apos; &apos; ) , 8 , &apos; &apos; ) )"
           descriptiveExpression="CUSAG" order="13" width="8"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="QUALIF" datatype="vchar2" columnOrder="22" width="3"
         defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Qualif" breakOrder="none">
          <xmlSettings xmlTag="&quot;qualif&quot;"/>
          <dataDescriptor expression="NVL ( qualif , &apos;   &apos; )"
           descriptiveExpression="QUALIF" order="14" width="3"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="RCODSG" datatype="vchar2" columnOrder="23" width="7"
         defaultWidth="60000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Rcodsg" breakOrder="none">
          <xmlSettings xmlTag="&quot;DPG_ress&quot;"/>
          <dataDescriptor
           expression="lpad ( NVL ( TO_CHAR ( rcodsg ) , &apos; &apos; ) , 7 , &apos;0&apos; )"
           descriptiveExpression="RCODSG" order="15" width="7"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUT" datatype="vchar2" columnOrder="24" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Cout" breakOrder="none">
          <xmlSettings xmlTag="&quot;cout_ht&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( cout , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( cout , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUT" order="16" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="VERIFSITU" datatype="vchar2" columnOrder="25"
         width="3" defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Verifsitu" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( verifsitu , &apos; &apos; ) , 3 , &apos; &apos; )"
           descriptiveExpression="VERIFSITU" order="17" width="3"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="FACTPID" datatype="vchar2" columnOrder="26" width="4"
         defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Factpid" breakOrder="none">
          <xmlSettings xmlTag="&quot;imputation&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( factpid , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="FACTPID" order="18" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SGSSII" datatype="vchar2" columnOrder="27" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Sgssii" breakOrder="none">
          <xmlSettings xmlTag="&quot;societe&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( sgssii , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SGSSII" order="19" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PLOCAL" datatype="vchar2" columnOrder="28" width="20"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Plocal" breakOrder="none">
          <xmlSettings xmlTag="&quot;paramètre local&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( plocal , &apos; &apos; ) , 20 , &apos; &apos; )"
           descriptiveExpression="PLOCAL" order="20" width="20"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CA_DPG_LIGNE" datatype="vchar2" columnOrder="38"
         width="6" defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ca Dpg Ligne" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( ca_dpg_ligne ) , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="CA_DPG_LIGNE" order="21" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CA_DPG_RESS" datatype="vchar2" columnOrder="39"
         width="6" defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ca Dpg Ress" breakOrder="none">
          <dataDescriptor
           expression="rpad ( NVL ( TO_CHAR ( ca_dpg_ress ) , &apos; &apos; ) , 6 , &apos; &apos; )"
           descriptiveExpression="CA_DPG_RESS" order="22" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="METIER" datatype="vchar2" columnOrder="40" width="3"
         defaultWidth="30000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Metier" breakOrder="none">
          <xmlSettings xmlTag="&quot;Métier&quot;"/>
          <dataDescriptor
           expression="rpad ( NVL ( metier , &apos; &apos; ) , 3 , &apos; &apos; )"
           descriptiveExpression="METIER" order="23" width="3"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="COUTHTR" datatype="vchar2" columnOrder="41" width="13"
         defaultWidth="100000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Couthtr" breakOrder="none">
          <xmlSettings xmlTag="&quot;Coût htr&quot;"/>
          <dataDescriptor
           expression="decode ( : P_param6 , &apos;.CSV&apos; , lpad ( NVL ( TO_CHAR ( couthtr , &apos;FM9999999990D00&apos; , &apos;NLS_NUMERIC_CHARACTERS=&apos;&apos;,.&apos; ) , &apos;0&apos; ) , 13 , &apos; &apos; ) , lpad ( NVL ( TO_CHAR ( couthtr , &apos;FM9999999999.00&apos; ) , &apos;0.00&apos; ) , 13 , &apos; &apos; ) )"
           descriptiveExpression="COUTHTR" order="24" width="13"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="SOCGRPE" datatype="vchar2" columnOrder="49" width="4"
         defaultWidth="40000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Socgrpe">
          <xmlSettings xmlTag="Groupe Sté"/>
          <dataDescriptor
           expression="rpad ( NVL ( socgrpe , &apos; &apos; ) , 4 , &apos; &apos; )"
           descriptiveExpression="SOCGRPE" order="11" width="4"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="TYPE_RESSOURCE" datatype="character"
         oracleDatatype="aFixedChar" columnOrder="51" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Rtype" breakOrder="none">
          <xmlSettings xmlTag="Type de ressource"/>
          <dataDescriptor expression="rtype"
           descriptiveExpression="TYPE_RESSOURCE" order="25"
           oracleDatatype="aFixedChar" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="MODE_CONTRACTUEL_INDICATIF" datatype="vchar2"
         columnOrder="50" width="5" defaultWidth="50000" defaultHeight="10000"
         columnFlags="0" defaultLabel="Rpad Nvl Mci 5" breakOrder="none">
          <xmlSettings xmlTag="Mode_contractuel_indicatif"/>
          <dataDescriptor
           expression="rpad ( NVL ( mci , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="MODE_CONTRACTUEL_INDICATIF" order="26"
           width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="DPCODE" datatype="vchar2" columnOrder="73" width="5"
         defaultWidth="70000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Dpcode">
          <dataDescriptor expression="RPAD ( NVL ( DPCODE , 0 ) , 5 , 0 )"
           descriptiveExpression="DPCODE" order="30" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CODE_PROJET" datatype="vchar2" columnOrder="66"
         width="5" defaultWidth="50000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Code Projet">
          <xmlSettings xmlTag="Code Projet"/>
          <dataDescriptor
           expression="RPAD ( NVL ( CODE_PROJET , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="CODE_PROJET" order="31" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CODE_APPLICATION" datatype="vchar2" columnOrder="67"
         width="5" defaultWidth="50000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Code Application">
          <xmlSettings xmlTag="Code Application"/>
          <dataDescriptor
           expression="RPAD ( NVL ( CODE_APPLICATION , &apos; &apos; ) , 5 , &apos; &apos; )"
           descriptiveExpression="CODE_APPLICATION" order="32" width="5"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CADA" datatype="vchar2" columnOrder="68" width="6"
         defaultWidth="80000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Cada">
          <dataDescriptor expression="LPAD ( NVL ( CADA , 0 ) , 6 , 0 )"
           descriptiveExpression="CADA" order="35" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CAFIRess" datatype="vchar2" columnOrder="70" width="6"
         defaultWidth="80000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Cafiress">
          <xmlSettings xmlTag="CAFIress"/>
          <dataDescriptor expression="LPAD ( NVL ( CAFI , 0 ) , 6 , 0 )"
           descriptiveExpression="CAFIRESS" order="33" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="CA_PAYEUR" datatype="vchar2" columnOrder="69"
         width="6" defaultWidth="80000" defaultHeight="10000" columnFlags="1"
         defaultLabel="Ca Payeur">
          <xmlSettings xmlTag="CA payeur"/>
          <dataDescriptor expression="LPAD ( NVL ( CA_PAYEUR , 0 ) , 6 , 0 )"
           descriptiveExpression="CA_PAYEUR" order="34" width="6"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PROFIL_FI_DYNA" datatype="vchar2" columnOrder="71"
         width="12" defaultWidth="100000" defaultHeight="10000"
         columnFlags="1" defaultLabel="Profil Fi Dyna">
          <xmlSettings xmlTag="Profil de FI Dyna."/>
          <dataDescriptor
           expression="RPAD ( DECODE ( : P_PARAM0 , &apos;fournisseur&apos; , DECODE ( pack_habilitation.isDpgMe ( rcodsg , : P_PERIME ) , &apos;O&apos; , DECODE ( : P_SMENUS_GES , &apos;O&apos; , NVL ( PROFIL_FI_DYNA , &apos; &apos; ) , &apos; &apos; ) , DECODE ( pack_habilitation.isPerimCafi ( CAFI , : P_PERIM_CAFI ) , &apos;N&apos; , &apos; &apos; , DECODE ( : P_SMENUS_GES , &apos;O&apos; , NVL ( PROFIL_FI_DYNA , &apos; &apos; ) , &apos; &apos; ) ) ) , &apos; &apos; ) , 12 , &apos; &apos; )"
           descriptiveExpression="PROFIL_FI_DYNA" order="28" width="12"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
        <dataItem name="PROFIL_FI_MENS" datatype="vchar2" columnOrder="72"
         width="4000" defaultWidth="100000" defaultHeight="10000"
         columnFlags="1" defaultLabel="Profil Fi Mens">
          <xmlSettings xmlTag="Profil de FI Mens."/>
          <dataDescriptor
           expression="DECODE ( : P_PARAM0 , &apos;fournisseur&apos; , DECODE ( pack_habilitation.isDpgMe ( rcodsg , : P_PERIME ) , &apos;O&apos; , DECODE ( : P_SMENUS_GES , &apos;O&apos; , NVL ( PROFIL_FI_MENS , &apos; &apos; ) , &apos; &apos; ) , DECODE ( pack_habilitation.isPerimCafi ( CAFI , : P_PERIM_CAFI ) , &apos;N&apos; , &apos; &apos; , DECODE ( : P_SMENUS_GES , &apos;O&apos; , NVL ( PROFIL_FI_MENS , &apos; &apos; ) , &apos; &apos; ) ) ) , &apos; &apos; )"
           descriptiveExpression="PROFIL_FI_MENS" order="29" width="4000"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
		
		<dataItem name="Ref_demande" datatype="vchar2" columnOrder="74" width="12"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ref_demande" breakOrder="none">
          <xmlSettings xmlTag="&quot;Ref_demande&quot;"/>
          <dataDescriptor
		   expression="decode( : P_param6 , &apos;.CSV&apos; , DECODE ( DPCOPIAXEMETIER , NULL , ( DECODE ( PROJAXEMETIER , NULL , &apos; &apos; , PROJAXEMETIER ) ) , DPCOPIAXEMETIER ) , rpad ( DECODE ( DPCOPIAXEMETIER , NULL , ( DECODE ( PROJAXEMETIER , NULL , &apos; &apos; , PROJAXEMETIER ) ) , DPCOPIAXEMETIER ) , 12 , &apos; &apos; ) )"
		   descriptiveExpression="REF_DEMANDE" order="36" width="12"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
		<dataItem name="Ref_demande_Lib" datatype="vchar2" columnOrder="75" width="80"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ref_demande_Lib" breakOrder="none">
          <xmlSettings xmlTag="&quot;Ref_demande_Lib&quot;"/>
          <dataDescriptor
		   expression="decode( : P_param6 , &apos;.CSV&apos; , DECODE ( DPCOPIAXEMETIER , NULL , ( DECODE ( PROJAXEMETIER , NULL , &apos; &apos; , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) , NULL , &apos;???&apos; , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) ) ) ) , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) , NULL , &apos;???&apos; , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) ) ) , rpad ( DECODE ( DPCOPIAXEMETIER , NULL , ( DECODE ( PROJAXEMETIER , NULL , &apos; &apos; , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) , NULL , &apos;???&apos; , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( PROJAXEMETIER ) AND ROWNUM = 1 ) ) ) ) , DECODE ( ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) , NULL , &apos;???&apos; , ( SELECT DMPLIBEL FROM DMP_RESEAUXFRANCE WHERE TRIM ( DMPNUM ) = TRIM ( DPCOPIAXEMETIER ) AND ROWNUM = 1 ) ) ) , 80 , &apos; &apos; ) )"
		   descriptiveExpression="REF_DEMANDE_LIB" order="37" width="80"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
		<dataItem name="DpCopiAxeMetier" datatype="vchar2" columnOrder="76" width="12"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="DpCopiAxeMetier" breakOrder="none">
          <xmlSettings xmlTag="&quot;DpCopiAxeMetier&quot;"/>
          <dataDescriptor
		   expression="decode( : P_param6 , &apos;.CSV&apos; , DPCOPIAXEMETIER , rpad ( NVL ( DPCOPIAXEMETIER , &apos; &apos; ) , 12 , &apos; &apos; ) )"
		   descriptiveExpression="DPCOPIAXEMETIER" order="38" width="12"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
		<dataItem name="ProjAxeMetier" datatype="vchar2" columnOrder="77" width="12"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="ProjAxeMetier" breakOrder="none">
          <xmlSettings xmlTag="&quot;ProjAxeMetier&quot;"/>
          <dataDescriptor
		   expression="decode( : P_param6 , &apos;.CSV&apos; , PROJAXEMETIER , rpad ( NVL ( PROJAXEMETIER , &apos; &apos; ) , 12 , &apos; &apos; ) )"
		   descriptiveExpression="PROJAXEMETIER" order="39" width="12"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
		
        <dataItem name="CH" datatype="vchar2" columnOrder="37" width="1"
         defaultWidth="10000" defaultHeight="10000" columnFlags="0"
         defaultLabel="Ch" breakOrder="none">
          <xmlSettings xmlTag=""/>
          <dataDescriptor
           expression="DECODE ( : P_PARAM6 , &apos;.TXT&apos; , CHR ( 13 ) , NULL )"
           descriptiveExpression="CH" order="27" width="1"/>
          <dataItemPrivate adtName="" schemaName=""/>
        </dataItem>
      </group>
    </dataSource>
  </data>
  <layout>
  <section name="header">
    <body>
      <text name="B_PID1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.00000" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Pid]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PTYPE1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.31250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[type]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PNOM1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="0.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[libellé]]>
          </string>
        </textSegment>
      </text>
      <text name="B_DPG_ligne1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.06250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[DPG_ligne]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PCMOUVRA1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.37500" y="0.00000" width="0.37500" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Pcmouvra]]>
          </string>
        </textSegment>
      </text>
      <text name="B_CDEB1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="1.87500" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cdeb]]>
          </string>
        </textSegment>
      </text>
      <text name="B_TIRES1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.18750" y="0.00000" width="0.25000" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Tires]]>
          </string>
        </textSegment>
      </text>
      <text name="B_AIST1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.56250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Aist]]>
          </string>
        </textSegment>
      </text>
      <text name="B_RNOM1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="2.87500" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Rnom]]>
          </string>
        </textSegment>
      </text>
      <text name="B_SOCCODE1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="3.18750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Soccode]]>
          </string>
        </textSegment>
      </text>
      <text name="B_COUTTC1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="3.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Couttc]]>
          </string>
        </textSegment>
      </text>
      <text name="B_CUSAG1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.06250" y="0.00000" width="0.25000" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cusag]]>
          </string>
        </textSegment>
      </text>
      <text name="B_QUALIF1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.43750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Qualif]]>
          </string>
        </textSegment>
      </text>
      <text name="B_RCODSG1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="4.87500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Rcodsg]]>
          </string>
        </textSegment>
      </text>
      <text name="B_COUT1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="5.31250" y="0.00000" width="0.18750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Cout]]>
          </string>
        </textSegment>
      </text>
      <text name="B_VERIFSITU1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="5.62500" y="0.00000" width="0.43750" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Verifsitu]]>
          </string>
        </textSegment>
      </text>
      <text name="B_FACTPID1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="6.18750" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Factpid]]>
          </string>
        </textSegment>
      </text>
      <text name="B_SGSSII1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="6.62500" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Sgssii]]>
          </string>
        </textSegment>
      </text>
      <text name="B_PLOCAL1" minWidowLines="1">
        <textSettings spacing="0"/>
        <geometryInfo x="7.06250" y="0.00000" width="0.31250" height="0.12500"
        />
        <textSegment>
          <font face="Courier New" size="5"/>
          <string>
          <![CDATA[Plocal]]>
          </string>
        </textSegment>
      </text>
    </body>
  </section>
  <section name="main">
    <body>
      <frame name="M_G_PID_GRPFR">
        <geometryInfo x="0.06250" y="0.00000" width="7.06250" height="0.25000"
        />
        <generalLayout verticalElasticity="variable"/>
        <repeatingFrame name="R_G_PID" source="G_PID" printDirection="down"
         minWidowRecords="1" columnMode="no">
          <geometryInfo x="0.06250" y="0.12500" width="7.06250"
           height="0.12500"/>
          <generalLayout verticalElasticity="expand"/>
          <field name="F_PID" source="PID" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="0.06250" y="0.12500" width="0.12500"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PTYPE" source="PTYPE" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="0.31250" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PNOM" source="PNOM" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="0.62500" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_DPG_ligne" source="DPG_ligne" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="1.00000" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PCMOUVRA" source="PCMOUVRA" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="1.31250" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CDEB" source="CDEB" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="1.75000" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_TIRES" source="TIRES" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="2.06250" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_AIST" source="AIST" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="2.37500" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_RNOM" source="RNOM" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="2.68750" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_SOCCODE" source="SOCCODE" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="3.00000" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUTTC" source="COUTTC" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="3.37500" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CUSAG" source="CUSAG" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="3.75000" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_QUALIF" source="QUALIF" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="4.06250" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_RCODSG" source="RCODSG" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="4.43750" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUT" source="COUT" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="4.81250" y="0.12500" width="0.18750"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_VERIFSITU" source="VERIFSITU" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="5.12500" y="0.12500" width="0.31250"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_FACTPID" source="FACTPID" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="5.56250" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_SGSSII" source="SGSSII" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="5.93750" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_PLOCAL" source="PLOCAL" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="6.31250" y="0.12500" width="0.25000"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_CH" source="CH" minWidowLines="1" spacing="0"
           alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="6.68750" y="0.12500" width="0.12500"
             height="0.12500"/>
            <generalLayout verticalElasticity="expand"/>
          </field>
          <field name="F_COUTHTR" source="COUTHTR" minWidowLines="1"
           spacing="0" alignment="start">
            <font face="Courier New" size="4"/>
            <geometryInfo x="6.87500" y="0.12500" width="0.18750"
             height="0.12500"/>
          </field>
        </repeatingFrame>
        <frame name="M_G_PID_HDR">
          <geometryInfo x="0.06250" y="0.00000" width="7.06250"
           height="0.12500"/>
          <advancedLayout printObjectOnPage="allPage"
           basePrintingOn="anchoringObject"/>
          <text name="B_PID" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.06250" y="0.00000" width="0.12500"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Pid]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PTYPE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.31250" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[type]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PNOM" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="0.62500" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[libellé]]>
              </string>
            </textSegment>
          </text>
          <text name="B_DPG_ligne" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.00000" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[DPG_ligne]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PCMOUVRA" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.31250" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Pcmouvra]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CDEB" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="1.75000" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Cdeb]]>
              </string>
            </textSegment>
          </text>
          <text name="B_TIRES" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.06250" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Tires]]>
              </string>
            </textSegment>
          </text>
          <text name="B_AIST" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.37500" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Aist]]>
              </string>
            </textSegment>
          </text>
          <text name="B_RNOM" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="2.68750" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Rnom]]>
              </string>
            </textSegment>
          </text>
          <text name="B_SOCCODE" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.00000" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Soccode]]>
              </string>
            </textSegment>
          </text>
          <text name="B_COUTTC" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.37500" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Couttc]]>
              </string>
            </textSegment>
          </text>
          <text name="B_CUSAG" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="3.75000" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Cusag]]>
              </string>
            </textSegment>
          </text>
          <text name="B_QUALIF" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.06250" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Qualif]]>
              </string>
            </textSegment>
          </text>
          <text name="B_RCODSG" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.43750" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Rcodsg]]>
              </string>
            </textSegment>
          </text>
          <text name="B_COUT" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="4.81250" y="0.00000" width="0.18750"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Cout]]>
              </string>
            </textSegment>
          </text>
          <text name="B_VERIFSITU" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="5.12500" y="0.00000" width="0.31250"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Verifsitu]]>
              </string>
            </textSegment>
          </text>
          <text name="B_FACTPID" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="5.56250" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Factpid]]>
              </string>
            </textSegment>
          </text>
          <text name="B_SGSSII" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="5.93750" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Sgssii]]>
              </string>
            </textSegment>
          </text>
          <text name="B_PLOCAL" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="6.31250" y="0.00000" width="0.25000"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[Plocal]]>
              </string>
            </textSegment>
          </text>
          <text name="B_1" minWidowLines="1">
            <textSettings spacing="0"/>
            <geometryInfo x="6.75000" y="0.00000" width="0.36975"
             height="0.12500"/>
            <textSegment>
              <font face="Courier New" size="4"/>
              <string>
              <![CDATA[CoutHTR]]>
              </string>
            </textSegment>
          </text>
        </frame>
      </frame>
    </body>
  </section>
  </layout>
  <parameterForm>
  <text name="PB_1" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="1.32129" y="0.15979" width="1.38513" height="0.22205"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="12" bold="yes"/>
      <string>
      <![CDATA[Paramètres état]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_2" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.77441" y="0.49304" width="2.47888" height="0.18042"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="10" bold="yes"/>
      <string>
      <![CDATA[Entrer les valeurs des paramètres]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_param6" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="0.82629" width="0.60388" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param6]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_global" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.15955" width="0.54138" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Global]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_P_param7" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.49280" width="1.22559" height="0.25720"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param7:Code DPG]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_P_global" source="P_global" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.04492" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_P_param7" source="P_param7" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.35742" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_3" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.24316" y="1.87427" width="0.60388" height="0.14929"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Param8]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_P_param8" source="P_PARAM8" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="1.68701" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_4" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.20142" y="2.04028" width="0.92358" height="0.18970"/>
    <visualSettings lineWidth="1"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[P Desformat]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_1" source="DESTYPE" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.50000" y="2.00867" width="2.00000" height="0.26428"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_5" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.21875" y="2.37610" width="0.46875" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param 9]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_6" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.20837" y="2.62622" width="0.54163" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param 10]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_7" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.19788" y="2.82458" width="0.54163" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param 11]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_8" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.18750" y="3.04333" width="0.54163" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param 12]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_9" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.21875" y="3.27258" width="0.54163" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param 13]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_param9" source="P_PARAM9" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.48962" y="2.30310" width="1.89575" height="0.22925"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_param10" source="P_PARAM10" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.48962" y="2.56372" width="1.86450" height="0.20837"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_param11" source="P_PARAM11" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.45837" y="2.82458" width="1.92700" height="0.15625"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_param12" source="P_PARAM12" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.45837" y="3.03296" width="1.90625" height="0.20837"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_param13" source="P_PARAM13" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.45837" y="3.27258" width="1.96875" height="0.17712"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_param6" source="P_PARAM6" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.46875" y="0.78125" width="1.98962" height="0.22913"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <field name="PF_PARAM14" source="P_PARAM14" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.53125" y="3.48010" width="1.86462" height="0.18750"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  <text name="PB_10" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.21875" y="3.53259" width="0.50000" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param14]]>
      </string>
    </textSegment>
  </text>
  <text name="PB_11" pageNumber="1" minWidowLines="1">
    <textSettings spacing="single"/>
    <geometryInfo x="0.20837" y="3.72913" width="0.42712" height="0.13538"/>
    <textSegment>
      <font face="MS Sans Serif" size="8" bold="yes"/>
      <string>
      <![CDATA[param0]]>
      </string>
    </textSegment>
  </text>
  <field name="PF_param0" source="P_PARAM0" pageNumber="1" minWidowLines="1"
   spacing="0">
    <font size="0"/>
    <geometryInfo x="1.51038" y="3.71875" width="1.88550" height="0.21875"/>
    <visualSettings lineWidth="1" linePattern="solid"/>
  </field>
  </parameterForm>
  <programUnits>
    <function name="afterpform">
      <textSource>
      <![CDATA[function AfterPForm return boolean is
   l_param   VARCHAR2(40);
   p_dpg VARCHAR2(10) := '';
   l_where_dpg VARCHAR2(1000) := '';
   l_global pack_global.GlobalData;
   chaine_doss_proj 	VARCHAR2(5000);
   chaine_projet 			VARCHAR2(5000);	
   chaine_application	VARCHAR2(5000);
   chaine_ca_fi 			VARCHAR2(5000);
   chaine_ca_payeur		VARCHAR2(5000);
   chaine_cada 				VARCHAR2(5000);
   
   l_doss_proj 				VARCHAR2(5000);
   l_projet	 					VARCHAR2(5000);
   l_application			VARCHAR2(5000);
   l_cafi	 						VARCHAR2(5000);
   l_ca_payeur	 			VARCHAR2(5000);
   l_cada	 						VARCHAR2(5000);
    PAS_LIMIT         VARCHAR2(40);
   l_ssoumenu					VARCHAR2(100);
BEGIN
	
	-- P_PARAM15  : Role utilissateur : fournisseur ou client
	-- P_PARAM14  : dossier projet
	-- P_PARAM13 : projet
	-- P_PARAM12 : CADA
	-- P_PARAM11 : CA Payeur
	-- P_PARAM10 : CAFI
	-- P_PARAM9  : Application
	-- P_PARAM8  : Menu
	-- P_PARAM7  : CODSG
	-- P_PARAM6  : type de fichier de sortie ".CSV  ...."
	
	l_doss_proj 	:= '-1';
	l_projet 			:= '-1';
	l_application := '-1';
	l_cafi 				:= '-1';
	l_ca_payeur 	:= '-1';
	l_cada 				:= '-1';
   	
  PAS_LIMIT := 'Pas de limitation';
	-- Initialisation des paramètres	  
  :P_habili_DP := '';
  :P_habili_P  := '';
  :P_habili_A  :='';
  :P_habili_CAFI  :='';
 	:P_PERIME:='';
	--	:P_HAB := 'VIDE';
	:P_WHERE := '';   	

	:P_PERIME := pack_global.lire_perime(:P_GLOBAL);
	:P_PERIM_CAFI := pack_global.lire_ca_fi(:P_GLOBAL);
	
	l_ssoumenu := Pack_Global.lire_globaldata(:P_GLOBAL).sousmenus;
	IF ( INSTR(l_ssoumenu,'ges') > 0 ) THEN
		:P_SMENUS_GES := 'O';
	ELSE
		:P_SMENUS_GES := 'N';
	END IF;
	
   -- Teste si on a été lancé par le menu habilitation par référentiels
	IF :P_PARAM8='REF' THEN
  
	   -- Informations pour l'habilitation par référentiels
		:P_habili_DP := pack_global.lire_doss_proj(:P_GLOBAL);
	  :P_habili_P  := pack_global.lire_projet(:P_GLOBAL);
	  :P_habili_A  := pack_global.lire_appli(:P_GLOBAL);
	  :P_habili_CAFI  := pack_global.lire_ca_fi(:P_GLOBAL);
	  :P_habili_CADA  := pack_global.lire_ca_da(:P_GLOBAL);
	  :P_habili_ca_payeur  := pack_global.lire_ca_payeur(:P_GLOBAL);
	  	  
	  :P_habili_A := REPLACE(:P_habili_A,',',''',''');
	  :P_habili_P := REPLACE(:P_habili_P,',',''',''');
	  	  
	  IF (:P_habili_DP is null or :P_habili_DP='') THEN
			  :P_habili_DP := 'VIDE';
	  END IF;	
	  IF (:P_habili_P is null or :P_habili_P='') THEN
			  :P_habili_P := 'VIDE';
	  END IF;	
	  IF (:P_habili_A is null or :P_habili_A='') THEN
			  :P_habili_A := 'VIDE';
	  END IF;	
	  IF (:P_habili_CAFI is null or :P_habili_CAFI='') THEN
			  :P_habili_CAFI := 'VIDE';
	  END IF;	
	  IF (:P_habili_ca_payeur is null or :P_habili_ca_payeur='') THEN
			  :P_habili_ca_payeur := 'VIDE';
	  END IF;	
	  IF (:P_habili_CADA is null or :P_habili_CADA='') THEN
			  :P_habili_CADA := 'VIDE';
	  END IF;	
  	
-- QC 1321

	-- Dossier Projet :
	if(trim(:P_PARAM14) = 'Pas de limitation') then
		chaine_doss_proj := 'VIDE';
	elsif(trim(upper(:P_PARAM14)) = 'TOUS')	then
		if(:P_habili_DP IS NOT NULL AND :P_habili_DP <> 'TOUS' ) then
  		chaine_doss_proj := :P_habili_DP; -- seulement les dossiers projets actifs
		else
			chaine_doss_proj := 'VIDE';
		end if;	
	else
		chaine_doss_proj := :P_PARAM14;
	end if;	
  
  -- --srw.message(1,'chaine_doss_proj : '||chaine_doss_proj);
  
  -- Projet :
	if(trim(:P_PARAM13) = 'Pas de limitation') then
		chaine_projet := 'VIDE';
	elsif(trim(upper(:P_PARAM13)) = 'TOUS')	then
		if(:P_habili_P IS NOT NULL AND :P_habili_P <> 'TOUS' ) then
  		chaine_projet := :P_habili_P; -- seulement les projets actifs
		else
			chaine_projet := 'VIDE';	
		end if;	
	else
		chaine_projet := :P_PARAM13;
	end if;	

	-- --srw.message(1,'chaine_projet : '||chaine_projet);

	-- application :
	if(:P_PARAM9 = 'Pas de limitation') then
		chaine_application := 'VIDE';
	elsif(:P_PARAM9 = 'TOUS')	then
		if(:P_habili_A IS NOT NULL AND :P_habili_A <> 'TOUS' ) then
  		chaine_application := :P_habili_A; -- seulement les applications actifs
		else
			chaine_application := 'VIDE';	
		end if;	
	else
		chaine_application := :P_PARAM9;
	end if;	

--	--srw.message(1,'chaine_application : '||chaine_application);
	
  -- CAFI
 	if(trim(:p_param10) = 'Pas de limitation') then
		chaine_ca_fi := 'VIDE';
	elsif(trim(upper(:p_param10)) = 'TOUS')	then
		if(:P_habili_CAFI IS NOT NULL AND trim(upper(:P_habili_CAFI)) <> 'TOUS' ) then
  		chaine_ca_fi := :P_habili_CAFI;
		else
			chaine_ca_fi := 'VIDE';	
		end if;	
	else
		chaine_ca_fi := :p_param10;
	end if;	

--	--srw.message(1,'chaine_ca_fi : '||chaine_ca_fi);

  -- CA_PAYEUR
	if(:p_param11 = 'Pas de limitation') then
		chaine_ca_payeur := 'VIDE';
	elsif(trim(upper(:p_param11)) = 'TOUS')	then
		if(:P_HABILI_CA_PAYEUR IS NOT NULL AND trim(upper(:P_HABILI_CA_PAYEUR)) <> 'TOUS' ) then
  		chaine_ca_payeur := :P_HABILI_CA_PAYEUR;
		else
			chaine_ca_payeur := 'VIDE';	
		end if;	
	else
		chaine_ca_payeur := :p_param11;
	end if;	
	
--	--srw.message(1,'chaine_ca_payeur : '||chaine_ca_payeur);

  -- CADA
	if(trim(:P_PARAM12) = 'Pas de limitation') then
		chaine_cada := 'VIDE';
	elsif(trim(upper(:P_PARAM12)) = 'TOUS')	then
		if(:P_habili_CADA IS NOT NULL AND trim(upper(:P_habili_CADA)) <> 'TOUS' ) then
  		chaine_cada := :P_habili_CADA;
		else
			chaine_cada := 'VIDE';	
		end if;	
	else
		chaine_cada := :P_PARAM12;
	end if;	
	
--	--srw.message(1,'chaine_cada : '||chaine_cada);

-- Utilisation des filtres de l ihm

	-- Dossier projet
	if(chaine_doss_proj <> 'VIDE') then
		l_doss_proj := ' and l.DPCODE IN (' || chaine_doss_proj ||') ';
	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUN DP habilité
	elsif (:P_param14  != PAS_LIMIT  AND trim(upper(:P_habili_DP)) <> 'TOUS') then
		l_doss_proj := ' and l.DPCODE = NULL ';
	end if;
	
	-- projet
	if(chaine_projet <> 'VIDE') then 	
		l_projet := ' and l.ICPI IN ('''||chaine_projet||''') ';
	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUN Projet habilité
	elsif (:P_param13 != PAS_LIMIT AND trim(upper(:P_habili_P)) <> 'TOUS') then
		l_projet := ' and l.ICPI = NULL ';
	end if;

	-- application
	if( chaine_application <> 'VIDE') then 	
		l_application := ' AND l.airt IN ('''||chaine_application ||''') ';
	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUNE Application habilité
	elsif (:P_param9 != PAS_LIMIT AND trim(upper(:P_habili_A)) <> 'TOUS') then
		l_application := ' and l.airt = NULL ';
	end if;
	
	-- CAFI
	if( chaine_ca_fi <> 'VIDE') then 

  		l_cafi := ' AND si1.CAFI IN ( SELECT codcamo FROM centre_activite
                                         WHERE ( codcamo IN ('||	chaine_ca_fi ||')
                                       OR CANIV1 IN ('||	chaine_ca_fi ||')
                                       OR CANIV2 IN ('||	chaine_ca_fi ||')
                                       OR CANIV3 IN ('||	chaine_ca_fi ||')
                                       OR CANIV4 IN ('||	chaine_ca_fi ||')
                                       OR CANIV5 IN ('||	chaine_ca_fi ||')
                                       OR CANIV6 IN ('||	chaine_ca_fi ||') )
                                       AND (cdateferm is null or substr(TO_DATE(cdateferm, ''DD/MM/YYYY''), 7, 8) = substr(TO_DATE(sysdate, ''DD/MM/YYYY''), 7, 8))
                                       ) ';
 						    													
			
	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUN CAFI habilité
	elsif (:P_param10 != PAS_LIMIT AND trim(upper(:P_habili_CAFI)) <> 'TOUS') then
		l_cafi := ' and si1.CAFI = NULL ';
	end if;
	
	-- CA PAYEUR
	if( chaine_ca_payeur <> 'VIDE') then 	
  		l_ca_payeur := ' AND l.CODCAMO IN (SELECT codcamo FROM centre_activite 
  						           		 								WHERE ( codcamo IN ('||	chaine_ca_payeur ||')
	  						           												OR CANIV1 IN ('||	chaine_ca_payeur ||')
	  						           												OR CANIV2 IN ('||	chaine_ca_payeur ||')
	  						           												OR CANIV3 IN ('||	chaine_ca_payeur ||')
	  						           												OR CANIV4 IN ('||	chaine_ca_payeur ||')
	  						           												OR CANIV5 IN ('||	chaine_ca_payeur ||') 
	  						           												OR CANIV6 IN ('||	chaine_ca_payeur ||') )
  						           												 AND (cdateferm is null or substr(TO_DATE(cdateferm, ''DD/MM/YYYY''), 7, 8) = substr(TO_DATE(sysdate, ''DD/MM/YYYY''), 7, 8)) 
  						    												) ';		

	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUN CA Payeur habilité
	elsif (:P_param11  != PAS_LIMIT AND trim(upper(:P_habili_CA_PAYEUR)) <> 'TOUS') then
		l_ca_payeur := ' and l.CODCAMO = NULL ';
	end if;	

	-- CADA	
	if( chaine_cada <> 'VIDE') then 	
  		l_cada := ' AND PI.CADA IN ( SELECT codcamo FROM centre_activite 
  						           		 								WHERE ( codcamo IN ('||	chaine_cada ||')
	  						           												OR CANIV1 IN ('||	chaine_cada ||')
	  						           												OR CANIV2 IN ('||	chaine_cada ||')
	  						           												OR CANIV3 IN ('||	chaine_cada ||')
	  						           												OR CANIV4 IN ('||	chaine_cada ||')
	  						           												OR CANIV5 IN ('||	chaine_cada ||') 
	  						           												OR CANIV6 IN ('||	chaine_cada ||') )
  						           												 AND (cdateferm is null or substr(TO_DATE(cdateferm, ''DD/MM/YYYY''), 7, 8) = substr(TO_DATE(sysdate, ''DD/MM/YYYY''), 7, 8)) 
  						    												) ';		

	-- cas où on a rien dans le perimètre RTFE alors on considère AUCUN CADA habilité
	elsif (:P_param12  != PAS_LIMIT AND trim(upper(:P_habili_CADA)) <> 'TOUS') then
		l_cada := ' and PI.CADA = NULL ';
	end if;		
  
	-- creation du where	
		IF (l_doss_proj <> '-1') then
			:p_where := :p_where || l_doss_proj;
		end if;
		
		IF (l_projet <> '-1') then
			:p_where := :p_where || l_projet;
		end if;
		
		IF (l_application <> '-1') then
			:p_where := :p_where || l_application;
		end if;

		IF (l_cafi <> '-1') then
		--	--srw.message(1,'WWWW l_cafi : '||l_cafi);
			:p_where := :p_where || l_cafi;
		end if;					
			
		IF (l_ca_payeur <> '-1') then
			:p_where := :p_where || l_ca_payeur;
		end if;
		
		IF (l_cada <> '-1') then
			:p_where := :p_where || l_cada;
		end if;
		
	  ----srw.message(1,:P_WHERE);
	  

  	
	-- Le traitement n'a pas été lancé par le menu referentiel (il a pu été lancé par exemple par le menu administration )	
  ELSE 
	   -- Informations pour le lancement par les autres menus 	
		
		:P_HAB := '';

  	:P_WHERE := :P_WHERE || ' AND ((s.codsg IN (SELECT codsg FROM vue_dpg_perime where INSTR('''||:P_PERIME||''', codbddpg) > 0 ))'; 
  	:P_WHERE := :P_WHERE || ' OR (p.factpdsg IN (SELECT codsg FROM vue_dpg_perime where INSTR('''||:P_PERIME||''', codbddpg) > 0 )))'; 

	  -- Interprétation du code DPG ( param7)
    -- ================================================
    
   	-- On enlève tous les espaces
		p_dpg := RTRIM(LTRIM(:P_PARAM7)); 
		p_dpg := REPLACE(p_dpg,'*','%');
		
		IF LPAD(p_dpg, 7, '*') != '*******' OR p_dpg IS NULL THEN
			:P_WHERE := :P_WHERE || ' AND ( TO_CHAR(s.codsg, ''FM0000000'') like ''' || p_dpg || '''';
			:P_WHERE := :P_WHERE || '     OR  TO_CHAR(p.factpdsg, ''FM0000000'') like ''' || p_dpg || ''')';
		END IF;

	  ----srw.message(1,:P_WHERE);
	  
	END IF;		

  return (TRUE);
end;]]>
      </textSource>
    </function>
  </programUnits>
  <webSource>
  <![CDATA[<%@ taglib uri="/WEB-INF/lib/reports_tld.jar" prefix="rw" %> 
<%@ page language="java" import="java.io.*" errorPage="/rwerror.jsp" session="false" %>
<%@ page contentType="text/html;charset=ISO-8859-1" %>
<!--
<rw:report id="report"> 
<rw:objects id="objects">
</rw:objects>
-->

<html>

<head>
<meta name="GENERATOR" content="Oracle 9i Reports Developer"/>
<title> Your Title </title>

<rw:style id="yourStyle">
   <!-- Report Wizard inserts style link clause here -->
</rw:style>

</head>


<body>

<rw:dataArea id="yourDataArea">
   <!-- Report Wizard inserts the default jsp here -->
</rw:dataArea>



</body>
</html>

<!--
</rw:report> 
-->
]]>
  </webSource>
  <reportPrivate defaultReportType="tabular" versionFlags2="0" templateName=""
  />
  <reportWebSettings>
  <![CDATA[#NULL#]]>
  </reportWebSettings>
</report>